# Entity.jsonl 数据集分割说明

## 数据集信息
- **文件**: `entity.jsonl`
- **位置**: `HybridNER/dataset/conll03/navigation/`
- **格式**: JSONL (每行一个JSON对象)
- **类型**: 命名实体识别(NER)数据集
- **内容**: 中文文本 + 实体标注 + 关系标注

## 数据样例
```json
{
  "id": 1078,
  "text": "定位、导航与授时（PNT）服务为军事指挥控制...",
  "entities": [
    {"id": 150, "label": "对抗时间", "start_offset": 45, "end_offset": 50},
    {"id": 151, "label": "事件名称", "start_offset": 126, "end_offset": 130}
  ],
  "relations": [],
  "Comments": []
}
```

## 数据集特点
- **领域**: 军事导航与对抗相关
- **实体类型**: 包含"对抗国家"、"对抗时间"、"硬摧毁武器"、"压制式干扰技术"等军事专业实体
- **文本长度**: 从几百到几千字符不等
- **实体密度**: 平均每个样本包含多个实体标注

## 脚本介绍

### 1. split_entity_dataset.py (完整版)
**特点**:
- ✅ 详细的数据分析功能
- ✅ 实体标签分布统计  
- ✅ 按实体数量分层分割
- ✅ 分割结果验证
- ✅ 实体数量分组分析
- ✅ 完整的错误处理

**分层策略**:
- 按实体数量分组: 0个，1-5个，6-10个，11-20个，21+个
- 保证各数据集中实体分布均匀

### 2. split_simple_entity.py (简化版)  
**特点**:
- ⚡ 执行速度快
- 🎯 代码简洁明了
- 📊 基本统计信息
- 🔧 易于修改配置

## 使用方法

### 在 AutoDL 环境中使用

1. **进入数据集目录**:
```bash
cd /root/autodl-tmp/your-project/HybridNER/dataset/conll03/navigation
```

2. **检查文件是否存在**:
```bash
ls -la entity.jsonl
```

3. **运行分割脚本**:

**方法一: 使用简化版（推荐快速使用）**
```bash
python split_simple_entity.py
```

**方法二: 使用完整版（推荐详细分析）**
```bash
python split_entity_dataset.py
```

## 输出文件

分割后将生成3个文件：
- **entity_train.jsonl** - 训练集 (80%)
- **entity_val.jsonl** - 验证集 (10%)  
- **entity_test.jsonl** - 测试集 (10%)

## 默认配置

| 参数 | 值 | 说明 |
|------|----|----|
| 训练集比例 | 80% | 用于模型训练 |
| 验证集比例 | 10% | 用于调参和早停 |
| 测试集比例 | 10% | 用于最终评估 |
| 随机种子 | 42 | 确保结果可重现 |

## 自定义配置

如需修改分割比例，编辑脚本中的变量：
```python
TRAIN_RATIO = 0.8  # 训练集比例
VAL_RATIO = 0.1    # 验证集比例  
TEST_RATIO = 0.1   # 测试集比例
```

## 分割策略

### 完整版脚本策略
- **实体数量分层**: 按样本中实体数量分组分割
- **分组策略**: 
  - 0个实体: 无实体样本
  - 1-5个实体: 少量实体样本
  - 6-10个实体: 中等实体样本
  - 11-20个实体: 较多实体样本
  - 21+个实体: 大量实体样本
- **均匀分布**: 保证各数据集中不同实体密度样本的均匀分布

### 简化版脚本策略  
- **完全随机**: 简单随机打乱后按比例分割
- **高效执行**: 适合大数据集快速处理

## 数据分析输出

完整版脚本会显示：
```
=== 数据集分析 ===
总样本数量: 1421
总实体数量: 7839  
平均每个样本实体数: 5.52
最多实体数的样本: 52 个实体
最少实体数的样本: 0 个实体
平均文本长度: 1247.3 字符

实体标签分布 (Top 15):
  对抗国家: 2156 (27.5%)
  对抗时间: 1456 (18.6%)
  硬摧毁武器: 987 (12.6%)
  ...

实体数量分组情况:
  0 个实体: 45 样本
  1-5 个实体: 623 样本
  6-10 个实体: 456 样本
  11-20 个实体: 234 样本
  21+ 个实体: 63 样本
```

## 验证功能

完整版脚本会自动验证：
- ✅ ID 重复检查
- ✅ 实体标签分布对比
- ✅ 实体数量统计  
- ✅ 数据集大小验证
- ✅ 分组分布分析

## 注意事项

1. **文件编码**: 确保 entity.jsonl 为 UTF-8 编码
2. **内存占用**: 大文件会完全加载到内存
3. **备份建议**: 运行前建议备份原文件
4. **路径检查**: 确保在 navigation 目录下运行
5. **实体复杂性**: 该数据集包含军事专业术语，实体类型较为复杂

## 故障排除

| 问题 | 解决方案 |
|------|---------|
| 找不到文件 | 检查 entity.jsonl 是否在 navigation 目录 |
| JSON 解析错误 | 检查文件格式，查看错误行号 |
| 权限错误 | 检查目录读写权限 |
| 内存不足 | 使用简化版脚本或分批处理 |
| 实体标签异常 | 检查实体标注格式是否正确 |

## 数据集特色

### 军事导航专业领域
- 🎯 **专业术语**: 包含大量军事导航专业术语
- 🌐 **多国对抗**: 涉及多国军事对抗场景
- ⚔️ **武器装备**: 详细的武器装备实体标注
- 📍 **时空信息**: 丰富的时间、地点信息

### 实体类型丰富
- **对抗相关**: 对抗国家、对抗时间、对抗地点
- **武器装备**: 硬摧毁武器、导弹武器、电子战装备
- **技术手段**: 压制式干扰技术、欺骗式干扰技术
- **系统属性**: 导航系统属性、防御技术等

## 文件结构

分割完成后的目录结构：
```
navigation/
├── entity.jsonl                 # 原始数据集
├── entity_train.jsonl          # 训练集
├── entity_val.jsonl            # 验证集  
├── entity_test.jsonl           # 测试集
├── split_entity_dataset.py     # 完整版脚本
├── split_simple_entity.py      # 简化版脚本
└── README_entity分割说明.md    # 本说明文档
```

## 后续使用

分割后的数据集可用于：
- 🤖 **军事NER模型训练**: 专门针对军事领域的实体识别
- 📊 **对抗分析**: 军事对抗场景分析
- 🔬 **关系抽取**: 军事实体间关系研究  
- 📈 **专业领域评估**: 专业领域NER性能对比
- 🛡️ **信息安全**: 军事情报信息提取

## 性能建议

- **训练建议**: 由于是专业领域数据，建议使用预训练的中文BERT模型进行微调
- **标签不平衡**: 注意处理标签分布不均的问题
- **长文本处理**: 部分样本文本较长，注意序列长度限制
- **专业术语**: 建议构建专业词汇表辅助训练

---

**提示**: 该数据集包含军事相关内容，仅用于学术研究目的。如有任何问题，请检查脚本运行日志或查看错误信息。